'use client';

import { Gift } from 'lucide-react';
import { ScrollSmoother } from 'gsap/ScrollSmoother';
import { trackClick } from '@/lib/analytics';
import content from '@/content/landing.ru.json';

interface HeaderProps {
  onOpenGift: () => void;
  activeScreen: number;
}

export default function Header({ onOpenGift, activeScreen }: HeaderProps) {
  const handleOpenGift = () => {
    trackClick('header_open_gift');
    onOpenGift();
  };

  const handleLogoClick = () => {
    trackClick('header_logo_to_top');
    const smoother = ScrollSmoother.get();
    if (smoother) {
      smoother.scrollTo(0, true);
    } else {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    }
  };

  const isDarkScreen = activeScreen === 1 || activeScreen === 3 || activeScreen === 6;

  return (
    <header className="fixed top-0 left-0 right-0 z-50 pointer-events-none">
      <div className="container mx-auto px-4 flex items-start justify-between">
        <button 
          onClick={handleLogoClick}
          className={`${
            isDarkScreen ? 'bg-slate-900 shadow-brand-blue/10' : 'bg-white shadow-sm'
          } px-8 py-5 rounded-b-3xl pointer-events-auto cursor-pointer hover:shadow-md transition-all duration-500`}
          aria-label="Прокрутить к верху"
        >
          <svg
            width="195"
            height="50"
            viewBox="0 0 195 50"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            className="h-10 w-auto"
          >
            <g clipPath="url(#clip0_3478_4467)">
              <path
                d="M.268 1.388a.735.735 0 01.73-.735h10.99a8.314 8.314 0 015.9 2.404 8.376 8.376 0 012.484 5.884c0 3.551-2.347 6.444-5.69 7.794l5.272 9.813a.731.731 0 01-.655 1.12h-4.036a.657.657 0 01-.615-.347L9.535 17.094H5.273v9.842a.757.757 0 01-.743.733H.998a.729.729 0 01-.73-.733V1.388zM11.57 12.965c2.038 0 3.806-1.775 3.806-3.935a3.844 3.844 0 00-1.146-2.648 3.815 3.815 0 00-2.66-1.096H5.305v7.68h6.266zM27.22 1.388a.738.738 0 01.733-.736h15.648a.727.727 0 01.675.454c.037.09.055.185.055.282v3.157a.738.738 0 01-.45.68.727.727 0 01-.28.056H32.234v6.334h9.484a.752.752 0 01.73.732v3.21a.734.734 0 01-.73.732h-9.484v6.748h11.38a.728.728 0 01.73.733v3.166a.733.733 0 01-.73.732h-15.66a.73.73 0 01-.733-.732V1.388zM51.293 1.388a.736.736 0 01.45-.68.727.727 0 01.28-.056h3.538a.758.758 0 01.732.736v21.657h9.804a.728.728 0 01.73.733v3.158a.733.733 0 01-.73.732H52.023a.728.728 0 01-.73-.732V1.388zM72.668 1.388a.738.738 0 01.45-.68.727.727 0 01.28-.056h15.648a.73.73 0 01.73.736v3.157a.737.737 0 01-.733.736H77.665v6.334h9.497a.753.753 0 01.733.732v3.21a.738.738 0 01-.733.732h-9.497v6.748h11.38a.732.732 0 01.73.733v3.166a.737.737 0 01-.732.732H73.398a.728.728 0 01-.73-.732V1.388zM94.837 1.658a.684.684 0 01.655-1.006h3.918a.707.707 0 01.651.418l7.381 16.604h.267l7.373-16.604a.71.71 0 01.656-.426h3.921a.678.678 0 01.735.653.688.688 0 01-.082.353l-11.919 25.97a.684.684 0 01-.652.425h-.384a.685.685 0 01-.653-.425L94.837 1.658zM148.664.963a.728.728 0 01.73-.695h.962l15.983 17.056h.04V1.388a.752.752 0 01.213-.52.728.728 0 01.517-.215h3.538a.76.76 0 01.73.735V27.36a.722.722 0 01-.73.693h-.925l-16.06-17.714h-.038v16.596a.748.748 0 01-.055.28.734.734 0 01-.675.452h-3.5a.756.756 0 01-.73-.732V.963zM183.155 5.286h-5.882a.725.725 0 01-.519-.217.745.745 0 01-.211-.524V1.388a.733.733 0 01.73-.736h16.801a.733.733 0 01.733.736v3.157a.733.733 0 01-.733.735h-5.882v21.658a.755.755 0 01-.73.733h-3.577a.756.756 0 01-.73-.733V5.286z"
                fill={isDarkScreen ? "#FFFFFF" : "#0245EE"}
              />
              <path
                d="M143.701 26.666L131.865.693a.653.653 0 00-.66-.426h-.384a.686.686 0 00-.653.426L118.21 26.666a.68.68 0 00.653 1.003h3.346a1.154 1.154 0 001.116-.773l7.536-16.941h.115l7.613 16.94c.266.536.533.774 1.114.774h3.351a.679.679 0 00.647-1.003z"
                fill="#ED2D24"
              />
              <path
                d="M1.03 46.792l4.411-6.546v6.546h.831v-7.749h-.815l-4.395 6.45v-6.45H.23v7.749h.8zM12.09 46.792V43.15h4.38v3.642h.832v-7.749h-.832v3.369h-4.38v-3.369h-.83v7.749h.83zM24.527 46.792V39.78h2.285v-.738h-5.386v.738h2.27v7.01h.83zM34.35 46.984c1.28 0 2.254-.449 3.021-1.251l-.431-.545c-.655.705-1.55 1.074-2.526 1.074-1.822 0-2.94-1.395-3.02-3.08h6.457v-.224c0-2.23-1.295-4.107-3.644-4.107-2.142 0-3.725 1.812-3.725 4.058 0 2.39 1.615 4.075 3.868 4.075zm2.654-4.46h-5.61c.063-1.347.974-2.952 2.797-2.952 1.934 0 2.797 1.637 2.813 2.952zM45.913 46.984c2.062 0 3.452-1.604 3.452-4.075 0-2.486-1.39-4.058-3.452-4.058-1.15 0-2.142.625-2.685 1.411v-1.219h-.831v10.7h.83V45.54c.624.883 1.599 1.444 2.686 1.444zm-.144-.754c-1.07 0-2.094-.673-2.541-1.411v-3.835c.447-.738 1.47-1.38 2.541-1.38 1.726 0 2.701 1.428 2.701 3.305 0 1.877-.975 3.321-2.701 3.321zM54.694 46.792V43.15h4.38v3.642h.831v-7.749h-.831v3.369h-4.38v-3.369h-.83v7.749h.83zM68.313 46.984c1.279 0 2.254-.449 3.021-1.251l-.431-.545c-.656.705-1.55 1.074-2.526 1.074-1.822 0-2.94-1.395-3.02-3.08h6.457v-.224c0-2.23-1.295-4.107-3.644-4.107-2.142 0-3.725 1.812-3.725 4.058 0 2.39 1.615 4.075 3.868 4.075zm2.654-4.46h-5.61c.063-1.347.974-2.952 2.796-2.952 1.934 0 2.798 1.637 2.814 2.952zM78.597 46.792V39.78h2.286v-.738h-5.387v.738h2.27v7.01h.83zM94.555 43.294v-.77h-3.836v.77h3.836zM110.995 46.792v-5.455c0-1.732-1.246-2.486-2.813-2.486-1.278 0-2.173.433-2.973 1.3l.464.577c.703-.803 1.454-1.14 2.413-1.14 1.151 0 2.078.626 2.078 1.781v1.572c-.671-.754-1.55-1.107-2.621-1.107-1.343 0-2.701.883-2.701 2.567 0 1.669 1.374 2.583 2.701 2.583 1.071 0 1.934-.353 2.621-1.107v.915h.831zm-3.164-.465c-1.279 0-2.11-.819-2.11-1.91 0-1.107.831-1.925 2.11-1.925.927 0 1.79.37 2.333 1.075v1.7c-.543.707-1.406 1.06-2.333 1.06zM121.057 39.043h-5.067v7.749h.831V39.78h4.236v-.738zM128.598 46.984c1.279 0 2.254-.449 3.021-1.251l-.431-.545c-.655.705-1.551 1.074-2.526 1.074-1.822 0-2.941-1.395-3.02-3.08h6.457v-.224c0-2.23-1.295-4.107-3.644-4.107-2.142 0-3.725 1.812-3.725 4.058 0 2.39 1.615 4.075 3.868 4.075zm2.654-4.46h-5.61c.063-1.347.975-2.952 2.797-2.952 1.934 0 2.797 1.637 2.813 2.952zM137.476 46.792V43.15h4.379v3.642h.831v-7.749h-.831v3.369h-4.379v-3.369h-.831v7.749h.831zM149.911 46.792V39.78h2.286v-.738h-5.386v.738h2.269v7.01h.831zM159.623 46.984c1.343 0 2.11-.53 2.734-1.331l-.576-.514c-.559.77-1.263 1.091-2.11 1.091-1.806 0-2.909-1.46-2.909-3.32 0-1.862 1.103-3.305 2.909-3.305.847 0 1.551.304 2.11 1.075l.576-.514c-.624-.786-1.391-1.315-2.734-1.315-2.269 0-3.756 1.796-3.756 4.058 0 2.262 1.487 4.075 3.756 4.075zM168.847 46.792V39.78h2.286v-.738h-5.387v.738h2.27v7.01h.831zM179.278 46.792c1.342 0 2.174-.803 2.174-2.102 0-.866-.608-1.684-1.375-1.893.639-.192 1.231-.834 1.231-1.765 0-1.235-.831-1.989-2.094-1.989h-3.964v7.749h4.028zm-.176-.754h-3.021v-2.872h3.021c.975 0 1.471.722 1.471 1.46 0 .882-.544 1.412-1.471 1.412zm-.032-3.61h-2.989v-2.647h2.989c.879 0 1.375.53 1.375 1.331 0 .738-.48 1.316-1.375 1.316zM189.556 46.984c2.286 0 3.724-1.813 3.724-4.075 0-2.262-1.438-4.058-3.724-4.058-2.254 0-3.708 1.796-3.708 4.058 0 2.262 1.454 4.075 3.708 4.075zm0-.754c-1.79 0-2.813-1.588-2.813-3.32 0-1.717 1.023-3.305 2.813-3.305 1.822 0 2.829 1.588 2.829 3.304 0 1.733-1.007 3.321-2.829 3.321z"
                fill={isDarkScreen ? "#FFFFFF" : "#343434"}
              />
            </g>
            <defs>
              <clipPath id="clip0_3478_4467">
                <path fill="#fff" d="M0 0h195v50H0z" />
              </clipPath>
            </defs>
          </svg>
        </button>
        <button
          onClick={handleOpenGift}
          className="mt-4 pointer-events-auto flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-brand-blue to-brand-light text-white rounded-full hover:from-brand-dark hover:to-brand-blue transition-all text-sm font-medium shadow-xl shadow-brand-blue/25 hover:scale-105 active:scale-95"
          aria-label="Открыть послание"
        >
          <Gift className="w-4 h-4" />
          {content.header.ctaToGift}
        </button>
      </div>
    </header>
  );
}
